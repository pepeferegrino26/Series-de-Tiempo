rm(list = ls())
######
install.packages("forecast")
library(forecast)
library(readxl)
compras<- read_excel("C://Users//SALA-F24//Desktop//BD//base.xlsx")
View(compras)
compras.ts<- ts(compras, start = c(2000), end = c(2013), frequency = 12)
plot(compras.ts, col="blue")
#descomposiciomn
descompuesta<- decompose(compras.ts,"multiplicative")
plot(descompuesta)

############ DESCOMPOSICION  CON  AJUSTE ESTACIONAL Y DE TENDENCIA CON LA FUNCION STL()
descompuesta.stl<- stl(compras.ts, t.window = 12, s.window = "periodic")
windows()
plot(descompuesta.stl)
pronosticos<- stl(compras.ts, t.window = 12, s.window = "periodic", robust = T)
ajustada<- seasadj(pronosticos)
plot(ajustada)
plot(naive(ajustada))
pronosticos.naive<- forecast(pronosticos, method = "naive")
plot(pronosticos.naive)
summary(pronosticos.naive)
